<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ecrew Absensi - Transwisata Prima Aviation (Real-time Database)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%); }
        .card-shadow { box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .loading { animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="min-h-screen bg-gray-50">
    <!-- Header -->
    <div class="gradient-bg text-white py-6 px-4">
        <div class="max-w-4xl mx-auto">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold">Ecrew Absensi</h1>
                    <p class="text-blue-100">Transwisata Prima Aviation - Real-time Database</p>
                </div>
                <div class="text-right">
                    <p class="text-sm text-blue-100">Tanggal Hari Ini</p>
                    <p class="text-lg font-semibold" id="currentDate"></p>
                    <div class="flex items-center justify-end mt-1">
                        <div class="w-2 h-2 bg-green-400 rounded-full mr-2" id="connectionStatus"></div>
                        <span class="text-xs text-blue-100" id="connectionText">Connected</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-4xl mx-auto px-4 py-8">
        <!-- Setup Database -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-6 mb-8" id="setupCard">
            <h2 class="text-lg font-semibold text-yellow-800 mb-4">üîß Setup Database Spreadsheet</h2>
            <p class="text-yellow-700 mb-4">Masukkan Google Apps Script Web App URL untuk koneksi database:</p>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-yellow-700 mb-2">Google Apps Script Web App URL</label>
                    <input type="url" id="webAppUrl" placeholder="https://script.google.com/macros/s/your-script-id/exec"
                           class="w-full px-4 py-3 border border-yellow-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent">
                    <p class="text-xs text-yellow-600 mt-1">Dapatkan URL ini setelah deploy Google Apps Script</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-yellow-700 mb-2">Google Sheets ID</label>
                    <input type="text" id="sheetsId" placeholder="1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms"
                           class="w-full px-4 py-3 border border-yellow-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent">
                    <p class="text-xs text-yellow-600 mt-1">ID dari URL Google Sheets Anda</p>
                </div>
                <div class="flex gap-4">
                    <button onclick="setupDatabase()" 
                            class="bg-yellow-600 hover:bg-yellow-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        üîó Connect Database
                    </button>
                    <button onclick="createGoogleScript()" 
                            class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        üìù Download Script
                    </button>
                    <button onclick="testConnection()" 
                            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        üß™ Test Connection
                    </button>
                </div>
            </div>
            
            <!-- Instructions -->
            <div class="mt-6 p-4 bg-white rounded-lg border border-yellow-200">
                <h3 class="font-semibold text-yellow-800 mb-2">üìã Langkah Setup:</h3>
                <ol class="text-sm text-yellow-700 space-y-1 list-decimal list-inside">
                    <li>Buat Google Sheets baru untuk database absensi</li>
                    <li>Copy ID dari URL Google Sheets (bagian setelah /d/)</li>
                    <li>Klik "Download Script" untuk mendapatkan Google Apps Script</li>
                    <li>Buka script.google.com, buat project baru, paste script</li>
                    <li>Deploy sebagai Web App dengan akses "Anyone"</li>
                    <li>Copy URL Web App dan masukkan di form di atas</li>
                    <li>Klik "Connect Database" untuk menghubungkan</li>
                </ol>
            </div>
        </div>

        <!-- Form Absensi -->
        <div class="bg-white rounded-xl card-shadow p-6 mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-6">Form Absensi Karyawan</h2>
            
            <form id="attendanceForm" class="space-y-4">
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
                        <input type="text" id="employeeName" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ID Karyawan</label>
                        <input type="text" id="employeeId" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>

                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Departemen</label>
                        <select id="department" required 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Pilih Departemen</option>
                            <option value="Flight Operations">Flight Operations</option>
                            <option value="Ground Operations">Ground Operations</option>
                            <option value="Maintenance">Maintenance</option>
                            <option value="Customer Service">Customer Service</option>
                            <option value="Administration">Administration</option>
                            <option value="Security">Security</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Shift</label>
                        <select id="shift" required 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Pilih Shift</option>
                            <option value="Pagi (06:00-14:00)">Pagi (06:00-14:00)</option>
                            <option value="Siang (14:00-22:00)">Siang (14:00-22:00)</option>
                            <option value="Malam (22:00-06:00)">Malam (22:00-06:00)</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Status Kehadiran</label>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                        <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                            <input type="radio" name="status" value="Hadir" required class="mr-2 text-blue-600">
                            <span class="text-sm">‚úÖ Hadir</span>
                        </label>
                        <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                            <input type="radio" name="status" value="Terlambat" required class="mr-2 text-blue-600">
                            <span class="text-sm">‚è∞ Terlambat</span>
                        </label>
                        <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                            <input type="radio" name="status" value="Sakit" required class="mr-2 text-blue-600">
                            <span class="text-sm">üè• Sakit</span>
                        </label>
                        <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                            <input type="radio" name="status" value="Izin" required class="mr-2 text-blue-600">
                            <span class="text-sm">üìù Izin</span>
                        </label>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Keterangan (Opsional)</label>
                    <textarea id="notes" rows="3" 
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                              placeholder="Tambahkan keterangan jika diperlukan..."></textarea>
                </div>

                <div class="flex gap-4 pt-4">
                    <button type="submit" 
                            class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 flex items-center justify-center">
                        <span class="loading w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2 hidden" id="submitLoading"></span>
                        üìù Submit Absensi
                    </button>
                    <button type="button" onclick="refreshData()" 
                            class="bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">
                        üîÑ Refresh Data
                    </button>
                </div>
            </form>
        </div>

        <!-- Data Absensi -->
        <div class="bg-white rounded-xl card-shadow p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-semibold text-gray-800">Data Absensi Real-time</h2>
                <div class="flex items-center gap-4">
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium" id="totalCount">
                        Total: 0 karyawan
                    </span>
                    <button onclick="openSpreadsheet()" 
                            class="bg-gray-600 hover:bg-gray-700 text-white text-sm px-3 py-1 rounded-lg transition duration-200">
                        üìä Buka Spreadsheet
                    </button>
                </div>
            </div>

            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="bg-gray-50">
                            <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">No</th>
                            <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Tanggal</th>
                            <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Nama</th>
                            <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">ID</th>
                            <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Departemen</th>
                            <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Status</th>
                            <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Waktu</th>
                        </tr>
                    </thead>
                    <tbody id="attendanceTable">
                        <tr>
                            <td colspan="7" class="px-4 py-8 text-center text-gray-500">
                                <div class="loading w-6 h-6 border-2 border-gray-300 border-t-blue-600 rounded-full mx-auto mb-2"></div>
                                Memuat data dari database...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        let config = {
            webAppUrl: localStorage.getItem('webAppUrl') || '',
            sheetsId: localStorage.getItem('sheetsId') || '',
            isConnected: false
        };

        // Data storage
        let attendanceData = [];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentDate();
            if (config.webAppUrl && config.sheetsId) {
                document.getElementById('webAppUrl').value = config.webAppUrl;
                document.getElementById('sheetsId').value = config.sheetsId;
                document.getElementById('setupCard').style.display = 'none';
                connectToDatabase();
            }
            loadAttendanceData();
        });

        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('currentDate').textContent = 
                now.toLocaleDateString('id-ID', options);
        }

        function setupDatabase() {
            const webAppUrl = document.getElementById('webAppUrl').value.trim();
            const sheetsId = document.getElementById('sheetsId').value.trim();
            
            if (!webAppUrl || !sheetsId) {
                alert('Masukkan Web App URL dan Sheets ID terlebih dahulu!');
                return;
            }

            config.webAppUrl = webAppUrl;
            config.sheetsId = sheetsId;
            localStorage.setItem('webAppUrl', webAppUrl);
            localStorage.setItem('sheetsId', sheetsId);
            
            showNotification('Konfigurasi database tersimpan! Testing koneksi...', 'success');
            document.getElementById('setupCard').style.display = 'none';
            connectToDatabase();
        }

        function createGoogleScript() {
            const scriptContent = `function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const sheet = SpreadsheetApp.openById('${config.sheetsId || 'YOUR_SHEET_ID'}').getActiveSheet();
    
    // Add headers if sheet is empty
    if (sheet.getLastRow() === 0) {
      sheet.getRange(1, 1, 1, 9).setValues([['Timestamp', 'Tanggal', 'Nama', 'ID Karyawan', 'Departemen', 'Shift', 'Status', 'Waktu', 'Keterangan']]);
    }
    
    // Add new row
    sheet.appendRow([
      data.timestamp,
      data.date,
      data.name,
      data.employeeId,
      data.department,
      data.shift,
      data.status,
      data.time,
      data.notes || ''
    ]);
    
    return ContentService.createTextOutput(JSON.stringify({success: true}))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({success: false, error: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

function doGet(e) {
  try {
    const sheet = SpreadsheetApp.openById('${config.sheetsId || 'YOUR_SHEET_ID'}').getActiveSheet();
    const data = sheet.getDataRange().getValues();
    
    if (data.length <= 1) {
      return ContentService.createTextOutput(JSON.stringify({success: true, data: []}))
        .setMimeType(ContentService.MimeType.JSON);
    }
    
    const headers = data[0];
    const rows = data.slice(1);
    
    const result = rows.map(row => {
      const obj = {};
      headers.forEach((header, index) => {
        obj[header.toLowerCase().replace(/\\s+/g, '')] = row[index];
      });
      return obj;
    });
    
    return ContentService.createTextOutput(JSON.stringify({success: true, data: result}))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({success: false, error: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}`;

            const blob = new Blob([scriptContent], { type: 'text/plain' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', 'AbsensiScript.gs');
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            showNotification('Google Apps Script berhasil diunduh! Upload ke script.google.com', 'success');
        }

        async function testConnection() {
            if (!config.webAppUrl) {
                alert('Masukkan Web App URL terlebih dahulu!');
                return;
            }

            try {
                showNotification('Testing koneksi ke database...', 'success');
                const response = await fetch(config.webAppUrl);
                const result = await response.json();
                
                if (result.success) {
                    showNotification('Koneksi berhasil! Database siap digunakan.', 'success');
                    updateConnectionStatus(true);
                    config.isConnected = true;
                } else {
                    throw new Error(result.error || 'Connection failed');
                }
            } catch (error) {
                showNotification('Koneksi gagal: ' + error.message, 'error');
                updateConnectionStatus(false);
            }
        }

        function connectToDatabase() {
            updateConnectionStatus(true);
            config.isConnected = true;
            loadAttendanceData();
        }

        function updateConnectionStatus(connected) {
            const statusDot = document.getElementById('connectionStatus');
            const statusText = document.getElementById('connectionText');
            
            if (connected) {
                statusDot.className = 'w-2 h-2 bg-green-400 rounded-full mr-2';
                statusText.textContent = 'Connected';
            } else {
                statusDot.className = 'w-2 h-2 bg-red-400 rounded-full mr-2';
                statusText.textContent = 'Disconnected';
            }
        }

        function createSampleSheet() {
            const headers = ['Timestamp', 'Tanggal', 'Nama', 'ID Karyawan', 'Departemen', 'Shift', 'Status', 'Waktu', 'Keterangan'];
            const csvContent = headers.join(',') + '\n';
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', 'Template_Absensi_Transwisata.csv');
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            showNotification('Template spreadsheet berhasil diunduh! Upload ke Google Sheets dan bagikan URL-nya.', 'success');
        }

        async function loadAttendanceData() {
            try {
                if (config.isConnected && config.webAppUrl) {
                    // Load from Google Sheets via Apps Script
                    const response = await fetch(config.webAppUrl);
                    const result = await response.json();
                    
                    if (result.success) {
                        attendanceData = result.data.map(row => ({
                            timestamp: row.timestamp,
                            date: row.tanggal,
                            name: row.nama,
                            employeeId: row.idkaryawan,
                            department: row.departemen,
                            shift: row.shift,
                            status: row.status,
                            time: row.waktu,
                            notes: row.keterangan
                        }));
                        
                        // Also save to localStorage as backup
                        localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
                        updateConnectionStatus(true);
                    } else {
                        throw new Error(result.error || 'Failed to load data');
                    }
                } else {
                    // Load from localStorage as fallback
                    const storedData = JSON.parse(localStorage.getItem('attendanceData')) || [];
                    attendanceData = storedData;
                }
                
                displayAttendanceData();
            } catch (error) {
                console.error('Error loading data:', error);
                updateConnectionStatus(false);
                
                // Try to load from localStorage as fallback
                const storedData = JSON.parse(localStorage.getItem('attendanceData')) || [];
                attendanceData = storedData;
                displayAttendanceData();
                
                showNotification('Menggunakan data lokal - koneksi database bermasalah', 'error');
            }
        }

        function displayAttendanceData() {
            const tableBody = document.getElementById('attendanceTable');
            const totalCount = document.getElementById('totalCount');

            if (attendanceData.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-4 py-8 text-center text-gray-500">
                            ${config.isConnected ? 'Belum ada data absensi' : 'Hubungkan ke database untuk melihat data'}
                        </td>
                    </tr>
                `;
            } else {
                // Sort by most recent first
                const sortedData = [...attendanceData].sort((a, b) => 
                    new Date(b.timestamp) - new Date(a.timestamp)
                );

                tableBody.innerHTML = sortedData.map((record, index) => `
                    <tr class="border-t hover:bg-gray-50">
                        <td class="px-4 py-3 text-sm">${index + 1}</td>
                        <td class="px-4 py-3 text-sm">${record.date}</td>
                        <td class="px-4 py-3 text-sm font-medium">${record.name}</td>
                        <td class="px-4 py-3 text-sm">${record.employeeId}</td>
                        <td class="px-4 py-3 text-sm">${record.department}</td>
                        <td class="px-4 py-3 text-sm">
                            <span class="px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(record.status)}">
                                ${record.status}
                            </span>
                        </td>
                        <td class="px-4 py-3 text-sm">${record.time}</td>
                    </tr>
                `).join('');
            }

            totalCount.textContent = `Total: ${attendanceData.length} karyawan`;
        }

        function getStatusColor(status) {
            const colors = {
                'Hadir': 'bg-green-100 text-green-800',
                'Terlambat': 'bg-yellow-100 text-yellow-800',
                'Sakit': 'bg-red-100 text-red-800',
                'Izin': 'bg-blue-100 text-blue-800'
            };
            return colors[status] || 'bg-gray-100 text-gray-800';
        }

        // Form submission
        document.getElementById('attendanceForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            if (!config.isConnected) {
                alert('Hubungkan ke database terlebih dahulu!');
                return;
            }

            const submitButton = e.target.querySelector('button[type="submit"]');
            const loading = document.getElementById('submitLoading');
            
            // Show loading
            loading.classList.remove('hidden');
            submitButton.disabled = true;

            try {
                const formData = {
                    name: document.getElementById('employeeName').value,
                    employeeId: document.getElementById('employeeId').value,
                    department: document.getElementById('department').value,
                    shift: document.getElementById('shift').value,
                    status: document.querySelector('input[name="status"]:checked').value,
                    notes: document.getElementById('notes').value,
                    timestamp: new Date().toISOString(),
                    time: new Date().toLocaleTimeString('id-ID', { 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    }),
                    date: new Date().toLocaleDateString('id-ID')
                };

                // Check if employee already recorded today
                const today = new Date().toDateString();
                const existingRecord = attendanceData.find(record => 
                    record.employeeId === formData.employeeId && 
                    new Date(record.timestamp).toDateString() === today
                );

                if (existingRecord) {
                    throw new Error('Karyawan dengan ID ini sudah melakukan absensi hari ini!');
                }

                // Save to Google Sheets (simulated)
                await saveToSpreadsheet(formData);

                // Update local data
                attendanceData.push(formData);
                localStorage.setItem('attendanceData', JSON.stringify(attendanceData));

                // Reset form and reload data
                this.reset();
                displayAttendanceData();

                showNotification('Absensi berhasil disimpan ke database!', 'success');

            } catch (error) {
                console.error('Error saving data:', error);
                showNotification(error.message || 'Gagal menyimpan data ke database', 'error');
            } finally {
                // Hide loading
                loading.classList.add('hidden');
                submitButton.disabled = false;
            }
        });

        async function saveToSpreadsheet(data) {
            if (!config.webAppUrl) {
                throw new Error('Web App URL tidak dikonfigurasi');
            }

            try {
                const response = await fetch(config.webAppUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                
                if (!result.success) {
                    throw new Error(result.error || 'Gagal menyimpan ke spreadsheet');
                }

                return result;
            } catch (error) {
                console.error('Error saving to spreadsheet:', error);
                throw error;
            }
        }

        function refreshData() {
            showNotification('Memperbarui data dari database...', 'success');
            loadAttendanceData();
        }

        function openSpreadsheet() {
            if (config.sheetsId) {
                const sheetsUrl = `https://docs.google.com/spreadsheets/d/${config.sheetsId}/edit`;
                window.open(sheetsUrl, '_blank');
            } else {
                alert('Sheets ID belum dikonfigurasi!');
            }
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white font-medium z-50 ${
                type === 'success' ? 'bg-green-500' : 'bg-red-500'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Auto-refresh data every 2 minutes when connected
        setInterval(() => {
            if (config.isConnected) {
                loadAttendanceData();
            }
        }, 120000);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97bc4405229c9fe5',t:'MTc1NzMxMTY0Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
